{"version":3,"sources":["entities/Rectangle.ts","entities/Region.ts","entities/Category.ts","entities/Label.ts","api/crdbApi.ts","color.tsx","components/RegionEditor/RegionEditorController.ts","components/RegionEditor/index.tsx","utils/manipulateImage.ts","components/CategorySetting.tsx","components/RegionList.tsx","components/RegionEditorContainer.tsx","add_photo_alternate-black-48dp.svg","components/ImageList.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["Rectangle","_left","_top","_right","_bottom","width","right","left","height","bottom","top","l","Math","min","this","t","r","max","b","rectangle","value","Region","id","categoryId","label","x","y","abs","deepCopy","convertRegionsToPathRegions","regions","map","region","index","toPoints","convertPointsToRegions","regionObj","horizontalPointList","point","verticalPointList","points","verticalPoints","validate","Category","name","order","_id","_name","_order","Label","_categoryId","_label","BASE_API_ENDPOINT","handleErrors","response","ok","status","Error","fetchHash","imageFile","a","formData","FormData","append","fetch","method","body","then","json","fetchCategories","jsonObj","categories","categoryObj","fetchLabels","labels","labelObj","fetchPageRegionsUrl","imageIds","category","published","url","fetchPageRegions","console","log","hashes","submitPageRegionsUrl","submitPageRegions","idempotencyKey","regionsObj","JSON","stringify","headers","SELECTED_REGION_COLOR","REGION_LABEL_COLOR","TICK","SELECTED_REGION_OUTLINE_DISTANCE","RegionEditorController","canvas","callback","mode","regionList","image","selectedRegion","addedRegion","deletedRegion","deformedRegion","_focusedRegion","_editingRegion","_selectedRegion","imageWidth","imageHeight","marginTop","marginBottom","marginLeft","marginRight","clicking","onMouseDownListener","event","calcXRatio","offsetX","calcYRatio","offsetY","nearestRegionArray","nearestRegion","length","editingRegion","createRegion","onSelectedRegion","redraw","onMouseMoveListener","focusedRegion","onMouseUpListener","addRegion","onKeyDownListener","key","preventDefault","dist","shiftKey","altKey","shrink","metaKey","expand","move","deleteRegion","isNaN","parseInt","selectPrevRegion","selectNextRegion","changeRegionLabel","onKeyUpListener","minMarginPixel","ratio","marginHorizontal","marginVertical","filter","containsPoint","neighborScore","sort","scoreA","scoreB","list","onAddedRegion","deleteIndex","indexOf","slice","onDeletedRegion","count","toIndex","moveRegion","editingRectangle","endsWith","deform","deformRegionIndex","deformRegion","rect","newLeft","newTop","newRight","newBottom","newRegionList","onDeformRegion","labelRegionIndex","labelRegion","onChangedLabel","ctx","getContext","clearRect","drawImage","forEach","strokeStyle","Color","drawRegion","fillStyle","drawMarkers","topX","centerX","topY","fillRect","leftX","leftY","centerY","rightX","rightY","bottomX","bottomY","drawExpandMarkers","drawShrinkMarkers","strokeRect","useStyles","makeStyles","theme","createStyles","root","backgroundColor","palette","background","paper","canvasContainer","position","cursor","RegionEditor","props","classes","useState","cacheImage","setImage","regionEditorControllerRef","useRef","useEffect","resizeEvent","current","clientWidth","clientHeight","calcMargin","window","addEventListener","removeEventListener","canvasRef","regionEditorController","document","file","onResizeCompleted","fileReader","FileReader","onload","result","target","img","Image","src","readAsDataURL","manipulateImage","selectedCategory","className","ref","tabIndex","overflowY","formControl","margin","spacing","minWidth","selectEmpty","CategorySetting","categorySelect","getLabels","apis","onLabelsUpdated","getCategories","onCategoriesUpdated","onCategorySelected","FormControl","InputLabel","Select","onChange","categoryList","MenuItem","table","labelIndicator","display","RegionList","Box","moveOrder","fromIndex","resultRegionList","temp","moveOrderDown","newIndex","onChangeRegionList","moveOrderUp","orderIcons","TableCell","IconButton","onClick","selectedOrNot","labelValue","labelList","labelName","chipLabel","style","categorySettingCallback","TableContainer","component","Paper","Table","aria-label","TableHead","TableRow","align","TableBody","onRegionSelected","selectRegion","EditHistory","grid","regionEditor","title","flexGrow","menu","useStateRef","initialValue","setValue","RegionEditorContainer","uuidv4","editingFile","setEditingFile","editingCategory","setEditingCategory","isDirty","setDirty","showSaveConfirmDialog","setShowSaveDialog","anchorImportExportMenu","setAnchorImportExportMenu","importInput","setHashes","setCategoryList","setSelectedCategory","setLabelList","selectedRegionState","setSelectedRegion","selectedRegionRef","Array","regionListState","setRegionList","regionListRef","historyListState","setHistoryList","historyListRef","snackbarText","setSnackbarText","open","vertical","horizontal","state","setState","regionEditorCallback","addEditHistory","changedRegion","regionListCallback","newCategoryList","handleError","error","message","getRegions","selectedFile","onlineMode","h","ctrlKey","restoreEditHistory","clearEditHistory","dirty","lastHistoryIndex","latestHistory","newHistoryList","submitRegions","saveRegions","blob","Blob","type","URL","createObjectURL","createElement","appendChild","download","href","click","remove","revokeObjectURL","AppBar","Toolbar","Typography","variant","Tooltip","color","onTurnOnlineRequested","handleClose","handleExport","Menu","anchorEl","keepMounted","Boolean","onClose","disabled","currentTarget","accept","files","e","parse","readAsText","hidden","showImportExportMenu","Snackbar","autoHideDuration","anchorOrigin","Grid","container","item","xs","Container","handleSave","handleDiscard","Dialog","aria-labelledby","aria-describedby","DialogTitle","DialogContent","DialogContentText","DialogActions","Button","autoFocus","showSaveDialog","flexWrap","justifyContent","overflow","gridList","transform","imageBoxContainerSelected","border","imageBoxContainer","imageContainer","alignItems","objectFit","imagePlaceholder","boxFile","tapContainer","selectionBox","clearIcon","ImageList","imageFiles","setImageFiles","previewImages","setPreviewImages","fileInput","readFile","GridList","fileInputSnapshot","add_photo_alternate_black","alt","imageAlt","isSelected","onDelete","createPreviewImage","onFileSelected","splice","onFileListUpdated","createPreviewImages","multiple","unshift","KEY_AGREEMENT","LATEST_AGREEMENT_DATE","drawerHeight","main","drawerHeader","padding","mixins","toolbar","grow","textAlign","drawerHeaderShift","transition","transitions","create","easing","easeOut","duration","enteringScreen","drawer","drawerPaper","drawerHeaderPaper","paddingLeft","content","sharp","leavingScreen","contentShift","App","setOnlineMode","imageListShown","setImageListShown","fileList","setFileList","setFile","agreementDate","localStorage","getItem","agreementDialogShown","showAgreementDialog","rootElement","prevFile","currentIndex","nextFile","regionEditorContainerCallback","toggleDrawer","getHashList","f","exportRegions","hashList","onKeyDown","CssBaseline","rel","Drawer","anchor","clsx","elevation","setItem","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.02aaea6c.chunk.js","sourcesContent":["export class Rectangle {\n\n    private _left = 0;\n    set left(value: number) {\n        this._left = Math.min(Math.max(0, value), 1.0);\n    }\n    get left(): number {\n        return Math.min(this._left, this._right);\n    }\n\n    private _top = 0;\n    set top(value: number) {\n        this._top = Math.min(Math.max(0, value), 1.0);\n    }\n    get top(): number {\n        return Math.min(this._top, this._bottom);\n    }\n\n    private _right = 0;\n    set right(value: number) {\n        this._right = Math.min(Math.max(0, value), 1.0);\n    }\n    get right(): number {\n        return Math.max(this._left, this._right);\n    }\n\n    private _bottom = 0;\n    set bottom(value: number) {\n        this._bottom = Math.min(Math.max(0, value), 1.0);\n    }\n    get bottom(): number {\n        return Math.max(this._top, this._bottom);\n    }\n\n    get centerX(): number {\n        return this.left + this.width() / 2;\n    }\n    get centerY(): number {\n        return this.top + this.height() / 2;\n    }\n\n    width = () => { return this.right - this.left; }\n    height = () => { return this.bottom - this.top; }\n\n    validate() {\n        const l = Math.min(this.left, this.right);\n        const t = Math.min(this.top, this.bottom);\n        const r = Math.max(this.left, this.right);\n        const b = Math.max(this.top, this.bottom);\n\n        this.left = l;\n        this.top = t;\n        this.right = r;\n        this.bottom = b;\n    }\n\n    toString() {\n        return `left: ${this.left}, top: ${this.top}, right: ${this.right}, bottom: ${this.bottom}`\n    }\n\n    toPoints(): Array<{}> {\n        return [\n            {\n                \"x\": this.left,\n                \"y\": this.top,\n            },\n            {\n                \"x\": this.right,\n                \"y\": this.top,\n            },\n            {\n                \"x\": this.right,\n                \"y\": this.bottom,\n            },\n            {\n                \"x\": this.left,\n                \"y\": this.bottom,\n            }\n        ];\n    }\n\n    deepCopy(): Rectangle {\n        const rectangle = new Rectangle();\n        rectangle.left = this.left;\n        rectangle.top = this.top;\n        rectangle.right = this.right;\n        rectangle.bottom = this.bottom;\n\n        return rectangle;\n    }\n}","import { Rectangle } from './Rectangle'\n\nexport class Region {\n\n    id: number;\n    categoryId: number\n    label: number\n    rectangle: Rectangle\n\n    constructor(id: number, categoryId: number, label: number, rectangle: Rectangle) {\n        this.id = id;\n        this.categoryId = categoryId;\n        this.label = label;\n        this.rectangle = rectangle;\n    }\n\n    containsPoint(x: number, y: number): boolean {\n        if (x < this.rectangle.left) {\n            return false;\n        }\n        if (y < this.rectangle.top) {\n            return false;\n        }\n        if (x > this.rectangle.right) {\n            return false;\n        }\n        if (y > this.rectangle.bottom) {\n            return false;\n        }\n        return true;\n    }\n\n    neighborScore(x: number, y: number): number {\n        const l = Math.abs(this.rectangle.left - x);\n        const r = Math.abs(this.rectangle.right - x);\n        const t = Math.abs(this.rectangle.top - y);\n        const b = Math.abs(this.rectangle.bottom - y);\n\n        return Math.min(l, t, r, b)\n    }\n\n    deepCopy(): Region {\n        return new Region(this.id, this.categoryId, this.label, this.rectangle.deepCopy());\n    }\n}\n\nconst ORDER_UNIT = 5;\n\nexport function convertRegionsToPathRegions(regions: Array<Region>) {\n    return regions.map((region: Region, index: number) => {\n        return {\n            \"category_id\": region.categoryId,\n            \"label\": region.label,\n            \"order\": index * ORDER_UNIT,\n            \"points\": region.rectangle.toPoints()\n        }\n    });\n}\n\nfunction horizontalPoints(points: Array<{}>): Array<number> {\n    return points.map((point: any) => {\n        return point['x'] as number\n    });\n}\n\nfunction verticalPoints(points: Array<{}>): Array<number> {\n    return points.map((point: any) => {\n        return point['y'] as number\n    });\n}\n\nexport function convertPointsToRegions(regions): Array<Region> {\n    return regions.map((regionObj: any) => {\n        const id = regionObj['id'] ? regionObj['id'] : -1;\n        const categoryId = regionObj['category_id'];\n        const label = regionObj['label'];\n\n        const horizontalPointList = horizontalPoints(regionObj['points']);\n        const verticalPointList = verticalPoints(regionObj['points']);\n\n        const left = Math.min(...horizontalPointList);\n        const top = Math.min(...verticalPointList);\n        const right = Math.max(...horizontalPointList);\n        const bottom = Math.max(...verticalPointList);\n\n        const rectangle = new Rectangle()\n        rectangle.left = left;\n        rectangle.top = top;\n        rectangle.right = right;\n        rectangle.bottom = bottom;\n        rectangle.validate()\n\n        return new Region(id, categoryId, label, rectangle);\n    });\n}","export class Category {\n\n    private _id = 0;\n    get id(): number {\n        return this._id;\n    }\n\n    private _name = \"\";\n    get name(): string {\n        return this._name;\n    }\n\n    private _order = 0;\n    get order(): number {\n        return this._order;\n    }\n\n    constructor(id: number, name: string, order: number) {\n        this._id = id;\n        this._name = name;\n        this._order = order;\n    }\n}","export class Label {\n\n    private _categoryId = 0;\n    get categoryId(): number {\n        return this._categoryId;\n    }\n\n    private _label = 0;\n    get label(): number {\n        return this._label;\n    }\n\n    private _name = \"\";\n    get name(): string {\n        return this._name;\n    }\n\n    private _order = 0;\n    get order(): number {\n        return this._order;\n    }\n\n    constructor(categoryId: number, label: number, name: string, order: number) {\n        this._categoryId = categoryId;\n        this._label = label;\n        this._name = name;\n        this._order = order;\n    }\n}","import { convertRegionsToPathRegions, convertPointsToRegions, Region } from '../entities/Region';\nimport { Category } from '../entities/Category';\nimport { Label } from '../entities/Label';\n\nconst BASE_API_ENDPOINT = 'https://mrdb.keiji.dev/api/v1'\n\nconst handleErrors = (response: any) => {\n  if (response.ok) {\n    return response;\n  }\n\n  switch (response.status) {\n    case 400: throw Error('INVALID_TOKEN');\n    case 401: throw Error('UNAUTHORIZED');\n    case 500: throw Error('INTERNAL_SERVER_ERROR');\n    case 502: throw Error('BAD_GATEWAY');\n    case 404: throw Error('No region data found.');\n    default: throw Error('UNHANDLED_ERROR');\n  }\n}\n\nexport async function fetchHash(imageFile: File) {\n  const formData = new FormData();\n  formData.append('file', imageFile);\n  const response = await fetch(BASE_API_ENDPOINT + \"/hash\", { method: 'POST', body: formData })\n    .then(handleErrors);\n  return response.json();\n}\n\nexport async function fetchCategories() {\n  const response = await fetch(BASE_API_ENDPOINT + \"/category\")\n    .then(handleErrors);\n  const jsonObj = await response.json();\n  const categories = jsonObj['categories'].map((categoryObj: any) => {\n    const id = categoryObj['id'];\n    const name = categoryObj['name'];\n    const order = categoryObj['order'];\n    return new Category(id, name, order);\n  });\n\n  return categories;\n}\n\nexport async function fetchLabels(categoryId: number) {\n  const response = await fetch(BASE_API_ENDPOINT + `/category/${categoryId}`)\n    .then(handleErrors);\n  const jsonObj = await response.json();\n  const labels = jsonObj['labels'].map((labelObj: any) => {\n    const categoryId = labelObj['category_id'];\n    const label = labelObj['label'];\n    const name = labelObj['name'];\n    const order = labelObj['order'];\n    return new Label(categoryId, label, name, order);\n  });\n\n  return labels;\n}\n\nexport function fetchPageRegionsUrl(imageIds: {}, category: Category | null | undefined, published: boolean) {\n  let url = BASE_API_ENDPOINT + \"/page/\" + imageIds['dhash8'];\n  if (category && published) {\n    url += `/?category_id=${category.id}&published=true`;\n  } else if (category) {\n    url += `/?category_id=${category.id}`;\n  } else if (published) {\n    url += `/?published=true`;\n  }\n  return url;\n}\n\nexport async function fetchPageRegions(imageIds: {}, category: Category | undefined) {\n  const response = await fetch(fetchPageRegionsUrl(imageIds, category, false))\n    .then(handleErrors);\n  const jsonObj = await response.json();\n\n  const regions = convertPointsToRegions(jsonObj['regions']);\n  console.log(regions);\n\n  return {\n    hashes: imageIds,\n    regions: regions\n  };\n}\n\nfunction submitPageRegionsUrl(category: Category | undefined) {\n  let url = BASE_API_ENDPOINT + \"/page\";\n  if (category) {\n    url += \"?category_id=\" + category.id;\n  }\n  return url;\n}\n\nexport async function submitPageRegions(\n  idempotencyKey: string,\n  hashes: {},\n  regions: Array<Region>,\n  category: Category | undefined\n) {\n\n  const regionsObj = convertRegionsToPathRegions(regions);\n  const jsonObj = {\n    \"image_ids\": {\n      \"dhash8\": hashes[\"dhash8\"],\n      \"dhash12\": hashes[\"dhash12\"],\n      \"dhash16\": hashes[\"dhash16\"],\n    },\n    \"regions\": regionsObj\n  };\n\n  const body: string = JSON.stringify(jsonObj);\n\n  const response = await fetch(submitPageRegionsUrl(category), {\n    method: 'POST',\n    headers: {\n      \"Idempotency-Key\": idempotencyKey\n    },\n    body: body\n  });\n  return response.json();\n\n}","export const EDITING_REGION_COLOR = '#f44336';\nexport const SELECTED_REGION_COLOR = '#f44336';\n\nexport const REGION_LABEL_COLOR = [\n  '#4caf50',\n  '#2196f3',\n  '#ff9800',\n  '#ff5722',\n  '#5c6bc0',\n  '#ab47bc',\n  '#ec407a',\n  '#7e57c2',\n  '#26c6da',\n  '#26a69a',\n];\n\nexport const NOT_SELECTED_REGION_ALPHA = 'aa';\n","import { Category } from '../../entities/Category';\nimport { Rectangle } from '../../entities/Rectangle';\nimport { Region } from '../../entities/Region';\n\nimport * as Color from '../../color';\n\nconst TICK = 0.01;\nconst NEIGHBOR_THRESHOLD = 0.005;\n\nconst SELECTED_REGION_OUTLINE_DISTANCE = 0.004;\n\nconst MARKER_LENGTH = 8;\n\ntype Mode = 'move' | 'expand' | 'shrink';\n\nexport interface Callback {\n  onSelectedRegion(region: Region | null);\n  onChangedLabel(region: Region, regionList: Array<Region>);\n\n  onAddedRegion(addedRegion: Region, regionList: Array<Region>);\n  onDeletedRegion(deletedRegion: Region, regionList: Array<Region>);\n  onDeformRegion(deformedRegion: Region, regionList: Array<Region>);\n}\n\nexport class RegionEditorController {\n\n  category: Category | null | undefined = new Category(0, 'Unknown', 0);\n  label = 0;\n\n  private mode: Mode = 'move';\n\n  regionList: Region[] | null | undefined = [];\n  image: HTMLImageElement | null = null;\n\n  private canvas: HTMLCanvasElement\n\n  private callback: Callback = new (class implements Callback {\n    onSelectedRegion(selectedRegion: Region) {\n      // Do nothing\n    }\n    onAddedRegion(addedRegion: Region, regionList: Array<Region>) {\n      // Do nothing\n    }\n    onDeletedRegion(deletedRegion: Region, regionList: Array<Region>) {\n      // Do nothing\n    }\n    onChangedLabel(deletedRegion: Region, regionList: Array<Region>) {\n      // Do nothing\n    }\n    onDeformRegion(deformedRegion: Region, regionList: Array<Region>) {\n      // Do nothing\n    }\n  })();\n\n  private _focusedRegion: Region | null = null;\n  set focusedRegion(region: Region | null) {\n    this._focusedRegion = region;\n  }\n  get focusedRegion(): Region | null {\n    return this._focusedRegion;\n  }\n\n  private _editingRegion: Region | null = null;\n  set editingRegion(region: Region | null) {\n    this._editingRegion = region;\n  }\n  get editingRegion(): Region | null {\n    return this._editingRegion;\n  }\n\n  private _selectedRegion: Region | null = null;\n  set selectedRegion(region: Region | null) {\n    this._selectedRegion = region;\n  }\n  get selectedRegion(): Region | null {\n    return this._selectedRegion;\n  }\n\n  private imageWidth = 0;\n  private imageHeight = 0;\n\n  private marginTop = 0;\n  private marginBottom = 0;\n  private marginLeft = 0;\n  private marginRight = 0;\n\n  destroy() {\n    this.image = null;\n  }\n\n  calcMargin(\n    minMarginPixel: number\n  ) {\n    if (!this.image) {\n      return;\n    }\n\n    const ratio = Math.min(\n      this.canvas.width / this.image.width,\n      this.canvas.height / this.image.height\n    );\n\n    let marginHorizontal = this.canvas.width - (this.image.width * ratio);\n    let marginVertical = this.canvas.height - (this.image.height * ratio);\n\n    if (marginHorizontal < minMarginPixel * 2) {\n      marginHorizontal = minMarginPixel * 2;\n    }\n    if (marginVertical < minMarginPixel * 2) {\n      marginVertical = minMarginPixel * 2;\n    }\n\n    this.marginTop = marginVertical / 2;\n    this.marginBottom = marginVertical - this.marginTop;\n    this.marginLeft = marginHorizontal / 2;\n    this.marginRight = marginHorizontal - this.marginLeft;\n\n    this.imageWidth = this.canvas.width - marginHorizontal;\n    this.imageHeight = this.canvas.height - marginVertical;\n  };\n\n  calcXRatio(offsetX: number) {\n    return (offsetX - this.marginLeft) / this.imageWidth;\n  }\n\n  calcYRatio(offsetY: number) {\n    return (offsetY - this.marginTop) / this.imageHeight;\n  }\n\n  private clicking = false;\n\n  onMouseDownListener = (event) => {\n    this.clicking = true;\n\n    const x = this.calcXRatio(event.offsetX);\n    const y = this.calcYRatio(event.offsetY);\n\n    const nearestRegionArray = this.nearestRegion(x, y);\n    if (!nearestRegionArray) {\n      return;\n    }\n\n    if (nearestRegionArray.length > 0) {\n      this.selectedRegion = nearestRegionArray[0];\n    } else {\n      this.selectedRegion = null;\n      this.editingRegion = this.createRegion(x, y);\n    }\n    this.callback.onSelectedRegion(this.selectedRegion);\n    this.redraw();\n  };\n\n  onMouseMoveListener = (event) => {\n\n    const x = this.calcXRatio(event.offsetX);\n    const y = this.calcYRatio(event.offsetY);\n\n    if (this.clicking && this.editingRegion !== null) {\n      this.editingRegion.rectangle.right = x;\n      this.editingRegion.rectangle.bottom = y;\n      this.redraw()\n      return;\n\n    } else if (!this.clicking) {\n      const nearestRegionArray = this.nearestRegion(x, y);\n      if (!nearestRegionArray) {\n        return;\n      }\n\n      if (nearestRegionArray.length > 0) {\n        this.focusedRegion = nearestRegionArray[0];\n      } else {\n        this.focusedRegion = null;\n      }\n      this.redraw()\n      return;\n    }\n  }\n\n  onMouseUpListener = (event) => {\n    this.clicking = false;\n\n    const region = this.editingRegion\n    if (region) {\n      region.rectangle.validate();\n      this.editingRegion = null\n\n      if (region.rectangle.width() < TICK && region.rectangle.height() < TICK) {\n        return;\n      }\n\n      this.addRegion(region);\n    }\n  }\n\n  nearestRegion(x: number, y: number) {\n    if (!this.regionList) {\n      return null;\n    }\n\n    const filteredRegion = this.regionList.filter((region) => {\n      return region.containsPoint(x, y);\n    }).filter((region) => {\n      const score = region.neighborScore(x, y);\n      return score < NEIGHBOR_THRESHOLD;\n    });\n\n    // sort by neighbor score.\n    const sortedRegions = filteredRegion.sort((a, b) => {\n      const scoreA = a.neighborScore(x, y);\n      const scoreB = b.neighborScore(x, y);\n      if (scoreA < scoreB) {\n        return -1;\n      } else if (scoreA > scoreB) {\n        return 1;\n      }\n      return 0;\n    });\n    return sortedRegions;\n  }\n\n  onKeyDownListener = (event) => {\n\n    if (event.key === 'ArrowRight' || event.key === 'ArrowLeft' || event.key === 'ArrowUp' || event.key === 'ArrowDown') {\n      event.preventDefault();\n\n      const dist = TICK * (event.shiftKey ? 0.1 : 1.0);\n\n      if (event.altKey) {\n        this.shrink(event.key, dist);\n      } else if (event.metaKey) {\n        this.expand(event.key, dist);\n      } else {\n        this.move(event.key, dist);\n      }\n\n    } else if (event.key === 'Delete' || event.key === 'Clear' || event.key === 'Backspace' || event.key === 'd') {\n      event.preventDefault();\n\n      if (!this.selectedRegion) {\n        return;\n      }\n      this.deleteRegion(this.selectedRegion);\n\n    } else if (!isNaN(parseInt(event.key))) {\n      event.preventDefault();\n\n      if (!this.selectedRegion) {\n        return;\n      }\n      this.changeRegionLabel(this.selectedRegion, parseInt(event.key));\n\n    } else if (event.key === 'Escape') {\n      event.preventDefault();\n\n      this.editingRegion = null;\n    } else if (event.key === 'Enter') {\n      event.preventDefault();\n\n      if (event.shiftKey) {\n        this.selectPrevRegion();\n      } else {\n        this.selectNextRegion();\n      }\n    } else if (event.key === 'Meta') {\n      event.preventDefault();\n      this.mode = 'expand';\n    } else if (event.key === 'Alt') {\n      event.preventDefault();\n      this.mode = 'shrink';\n    } else {\n      console.log(event.key);\n    }\n\n    this.redraw();\n  }\n\n  onKeyUpListener = (event) => {\n    event.preventDefault();\n\n    if (event.key === 'Meta' && !event.altKey) {\n      this.mode = 'move';\n    } else if (event.key === 'Alt' && !event.metaKey) {\n      this.mode = 'move';\n    }\n\n    this.redraw();\n  }\n\n  addRegion(region: Region) {\n    const list = this.regionList ? this.regionList : [];\n\n    this.regionList = [...list, region];\n    this.callback.onAddedRegion(region, this.regionList)\n\n    this.selectedRegion = region;\n    this.callback.onSelectedRegion(region);\n  }\n\n  deleteRegion(region: Region) {\n    if (!this.regionList) {\n      return;\n    }\n\n    const deleteIndex = this.regionList.indexOf(region)\n    if (deleteIndex >= 0) {\n      this.regionList = [\n        ...this.regionList.slice(0, deleteIndex),\n        ...this.regionList.slice(deleteIndex + 1, this.regionList.length)\n      ];\n    }\n    this.callback.onDeletedRegion(region, this.regionList)\n\n    this.selectedRegion = null;\n    this.callback.onSelectedRegion(null);\n  }\n\n  moveRegion(count: number) {\n    if (!this.regionList || this.regionList.length === 0) {\n      return;\n    }\n\n    if (this.selectedRegion === null) {\n      this.selectedRegion = this.regionList[0];\n      return;\n    }\n\n    const index = this.regionList.indexOf(this.selectedRegion);\n    if (index > -1) {\n      const toIndex = index + count;\n      if (toIndex >= 0 && toIndex < this.regionList.length) {\n        this.selectedRegion = this.regionList[toIndex];\n        this.callback.onSelectedRegion(this.selectedRegion);\n      }\n    }\n  }\n\n  selectPrevRegion() {\n    this.moveRegion(-1);\n  }\n\n  selectNextRegion() {\n    this.moveRegion(+1);\n  }\n\n  constructor(\n    canvas: HTMLCanvasElement,\n    callback: Callback,\n  ) {\n    this.canvas = canvas;\n    this.callback = callback;\n  }\n\n  createRegion(x: number, y: number) {\n    const editingRectangle = new Rectangle();\n    editingRectangle.left = x;\n    editingRectangle.right = x;\n    editingRectangle.top = y;\n    editingRectangle.bottom = y;\n    const categoryId = this.category ? this.category.id : 0;\n    return new Region(-1, categoryId, this.label, editingRectangle)\n  }\n\n  shrink(key: string, dist: number): boolean {\n    this.mode = 'shrink';\n\n    if (key.endsWith('Left')) {\n      return this.deform(0, 0, -dist, 0);\n    } else if (key.endsWith('Up')) {\n      return this.deform(0, 0, 0, -dist);\n    } else if (key.endsWith('Right')) {\n      return this.deform(dist, 0, 0, 0);\n    } else if (key.endsWith('Down')) {\n      return this.deform(0, dist, 0, 0);\n    }\n    return false;\n  }\n\n  expand(key: string, dist: number): boolean {\n    this.mode = 'expand';\n\n    if (key.endsWith('Left')) {\n      return this.deform(-dist, 0, 0, 0);\n    } else if (key.endsWith('Up')) {\n      return this.deform(0, -dist, 0, 0);\n    } else if (key.endsWith('Right')) {\n      return this.deform(0, 0, dist, 0);\n    } else if (key.endsWith('Down')) {\n      return this.deform(0, 0, 0, dist);\n    }\n\n    return false;\n  }\n\n  move(key: string, dist: number): boolean {\n    this.mode = 'move';\n\n    if (key.endsWith('Left')) {\n      return this.deform(-dist, 0, -dist, 0);\n    } else if (key.endsWith('Up')) {\n      return this.deform(0, -dist, 0, -dist);\n    } else if (key.endsWith('Right')) {\n      return this.deform(dist, 0, dist, 0);\n    } else if (key.endsWith('Down')) {\n      return this.deform(0, dist, 0, dist);\n    }\n\n    return false;\n  }\n\n  deform(left: number, top: number, right: number, bottom: number): boolean {\n    if (!this.regionList || !this.selectedRegion) {\n      return false;\n    }\n\n    const deformRegionIndex = this.regionList.indexOf(this.selectedRegion);\n    if (deformRegionIndex < 0) {\n      return false;\n    }\n\n    const deformRegion = this.selectedRegion.deepCopy();\n    const rect = deformRegion.rectangle;\n\n    let newLeft = rect.left + left;\n    let newTop = rect.top + top;\n    let newRight = rect.right + right;\n    let newBottom = rect.bottom + bottom;\n\n    newLeft = Math.max(0, newLeft);\n    newTop = Math.max(0, newTop);\n    newRight = Math.min(1.0, newRight);\n    newBottom = Math.min(1.0, newBottom);\n\n    if (rect.left === newLeft\n      && rect.top === newTop\n      && rect.right === newRight\n      && rect.bottom === newBottom) {\n      return false;\n    }\n\n    rect.left = newLeft;\n    rect.top = newTop;\n    rect.right = newRight;\n    rect.bottom = newBottom;\n\n    const newRegionList = [\n      ...this.regionList.slice(0, deformRegionIndex),\n      deformRegion,\n      ...this.regionList.slice(deformRegionIndex + 1, this.regionList.length)\n    ];\n    this.regionList = newRegionList;\n    this.selectedRegion = deformRegion;\n\n    this.callback.onDeformRegion(deformRegion, this.regionList);\n    this.callback.onSelectedRegion(this.selectedRegion);\n\n    return true;\n  }\n\n  changeRegionLabel(region: Region, label: number) {\n    this.label = label;\n\n    if (!this.regionList) {\n      return false;\n    }\n\n    const labelRegionIndex = this.regionList.indexOf(region);\n    if (labelRegionIndex < 0) {\n      return false;\n    }\n\n    const labelRegion = region.deepCopy();\n    labelRegion.label = label;\n\n    const newRegionList = [\n      ...this.regionList.slice(0, labelRegionIndex),\n      labelRegion,\n      ...this.regionList.slice(labelRegionIndex + 1, this.regionList.length)\n    ];\n    this.regionList = newRegionList;\n    this.selectedRegion = labelRegion;\n\n    this.callback.onChangedLabel(labelRegion, this.regionList);\n    this.callback.onSelectedRegion(this.selectedRegion);\n\n    return true;\n  }\n\n  redraw() {\n    const ctx = this.canvas.getContext(\"2d\");\n    if (ctx === null) {\n      return;\n    }\n\n    ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\n    if (!this.image) {\n      return;\n    }\n\n    ctx.drawImage(\n      this.image,\n      this.marginLeft, this.marginTop,\n      this.imageWidth, this.imageHeight\n    );\n\n    if (!this.regionList) {\n      return;\n    }\n\n    this.regionList.forEach((region, index) => {\n      if (region === this.focusedRegion) {\n        ctx.strokeStyle = `${Color.REGION_LABEL_COLOR[region.label]}`;\n      } else {\n        ctx.strokeStyle = `${Color.REGION_LABEL_COLOR[region.label]}${Color.NOT_SELECTED_REGION_ALPHA}`;\n      }\n\n      this.drawRegion(region, ctx);\n\n      if (region === this.selectedRegion) {\n        ctx.fillStyle = `${Color.SELECTED_REGION_COLOR}`;\n        ctx.strokeStyle = `${Color.SELECTED_REGION_COLOR}`;\n\n        const selectedRegion = region.deepCopy();\n        selectedRegion.rectangle.left -= SELECTED_REGION_OUTLINE_DISTANCE;\n        selectedRegion.rectangle.top -= SELECTED_REGION_OUTLINE_DISTANCE;\n        selectedRegion.rectangle.right += SELECTED_REGION_OUTLINE_DISTANCE;\n        selectedRegion.rectangle.bottom += SELECTED_REGION_OUTLINE_DISTANCE;\n\n        this.drawRegion(selectedRegion, ctx);\n        this.drawMarkers(selectedRegion, ctx);\n      }\n    })\n\n    if (this.editingRegion) {\n      ctx.strokeStyle = `${Color.EDITING_REGION_COLOR}`;\n      this.drawRegion(this.editingRegion, ctx);\n    }\n  }\n\n  drawExpandMarkers(region: Region, ctx: CanvasRenderingContext2D) {\n    // top\n    const topX = region.rectangle.centerX * this.imageWidth + this.marginLeft;\n    const topY = region.rectangle.top * this.imageHeight + this.marginTop;\n    ctx.fillRect(topX, topY, 1, -MARKER_LENGTH);\n\n    // left\n    const leftX = region.rectangle.left * this.imageWidth + this.marginLeft;\n    const leftY = region.rectangle.centerY * this.imageHeight + this.marginTop;\n    ctx.fillRect(leftX, leftY, -MARKER_LENGTH, 1);\n\n    // right\n    const rightX = region.rectangle.right * this.imageWidth + this.marginLeft;\n    const rightY = region.rectangle.centerY * this.imageHeight + this.marginTop;\n    ctx.fillRect(rightX, rightY, MARKER_LENGTH, 1);\n\n    // bottom\n    const bottomX = region.rectangle.centerX * this.imageWidth + this.marginLeft;\n    const bottomY = region.rectangle.bottom * this.imageHeight + this.marginTop;\n    ctx.fillRect(bottomX, bottomY, 1, MARKER_LENGTH);\n  }\n\n  drawShrinkMarkers(region: Region, ctx: CanvasRenderingContext2D) {\n    // top\n    const topX = region.rectangle.centerX * this.imageWidth + this.marginLeft;\n    const topY = region.rectangle.top * this.imageHeight + this.marginTop;\n    ctx.fillRect(topX, topY, 1, MARKER_LENGTH);\n\n    // left\n    const leftX = region.rectangle.left * this.imageWidth + this.marginLeft;\n    const leftY = region.rectangle.centerY * this.imageHeight + this.marginTop;\n    ctx.fillRect(leftX, leftY, MARKER_LENGTH, 1);\n\n    // right\n    const rightX = region.rectangle.right * this.imageWidth + this.marginLeft;\n    const rightY = region.rectangle.centerY * this.imageHeight + this.marginTop;\n    ctx.fillRect(rightX, rightY, -MARKER_LENGTH, 1);\n\n    // bottom\n    const bottomX = region.rectangle.centerX * this.imageWidth + this.marginLeft;\n    const bottomY = region.rectangle.bottom * this.imageHeight + this.marginTop;\n    ctx.fillRect(bottomX, bottomY, 1, -MARKER_LENGTH);\n  }\n\n  drawMarkers(region: Region, ctx: CanvasRenderingContext2D) {\n    switch (this.mode) {\n      case \"move\": {\n        return;\n      }\n      case \"expand\": {\n        this.drawExpandMarkers(region, ctx);\n        return;\n      }\n      case \"shrink\": {\n        this.drawShrinkMarkers(region, ctx);\n        return;\n      }\n    }\n  }\n\n  drawRegion(region: Region, ctx: CanvasRenderingContext2D) {\n    const rect = region.rectangle;\n\n    ctx.strokeRect(\n      rect.left * this.imageWidth + this.marginLeft,\n      rect.top * this.imageHeight + this.marginTop,\n      rect.width() * this.imageWidth,\n      rect.height() * this.imageHeight\n    );\n  }\n}\n","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport * as React from 'react';\n\nimport { useEffect, useRef, useState } from 'react';\nimport { createStyles, makeStyles, Theme } from '@material-ui/core';\n\nimport { RegionEditorController, Callback as RegionEditorCallback } from './RegionEditorController';\nimport * as manipulateImage from \"../../utils/manipulateImage\";\nimport { Category } from '../../entities/Category';\nimport { Region } from '../../entities/Region';\n\nconst DEFAULT_LABEL = 0;\nconst DEFAULT_MARGIN = 16;\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    root: {\n        height: `100%`,\n        backgroundColor: theme.palette.background.paper,\n    },\n    canvasContainer: {\n        position: `relative`,\n        height: `100%`,\n        width: `100%`,\n    },\n    canvas: {\n        cursor: `crosshair`,\n    },\n}),\n);\n\ntype Props = {\n    file: File | null | undefined,\n    selectedCategory: Category | undefined,\n    regionList: Array<Region> | undefined,\n    selectedRegion: Region | null,\n    callback: RegionEditorCallback,\n}\n\nexport function RegionEditor(props: Props) {\n    const classes = useStyles();\n\n    const [cacheImage, setImage] = useState<HTMLImageElement | null>(null);\n    const regionEditorControllerRef = useRef<RegionEditorController | null>(null);\n\n    const canvasContainer = useRef<HTMLDivElement>(null);\n    const canvas = useRef<HTMLCanvasElement>(null);\n\n    // add/remove resize listeners\n    useEffect(() => {\n        const resizeEvent = (event) => {\n            if (!canvas.current) {\n                return;\n            }\n            if (!canvasContainer.current) {\n                return;\n            }\n\n            if (cacheImage && regionEditorControllerRef.current) {\n                canvas.current.width = canvasContainer.current.clientWidth;\n                canvas.current.height = canvasContainer.current.clientHeight;\n                regionEditorControllerRef.current.calcMargin(DEFAULT_MARGIN);\n                regionEditorControllerRef.current.redraw();\n            }\n        };\n\n        window.addEventListener(\"resize\", resizeEvent);\n\n        return () => {\n            window.removeEventListener(\"resize\", resizeEvent);\n        }\n    });\n\n    // add/remove mouse and key event listeners\n    useEffect(() => {\n        const canvasRef = canvas.current;\n        if (canvasRef) {\n            const regionEditorController = new RegionEditorController(\n                canvasRef,\n                props.callback\n            );\n\n            canvasRef.addEventListener(\"mousedown\", regionEditorController.onMouseDownListener);\n            canvasRef.addEventListener(\"mousemove\", regionEditorController.onMouseMoveListener);\n            canvasRef.addEventListener(\"mouseup\", regionEditorController.onMouseUpListener);\n\n            // https://qiita.com/jay-es/items/cd30c73989659374698a\n            document.addEventListener(\"keydown\", regionEditorController.onKeyDownListener);\n            document.addEventListener(\"keyup\", regionEditorController.onKeyUpListener);\n\n            regionEditorControllerRef.current = regionEditorController;\n        }\n\n        return () => {\n            if (canvasRef && regionEditorControllerRef.current) {\n                const regionEditorController = regionEditorControllerRef.current;\n                canvasRef.removeEventListener(\"mousedown\", regionEditorController.onMouseDownListener);\n                canvasRef.removeEventListener(\"mousemove\", regionEditorController.onMouseMoveListener);\n                canvasRef.removeEventListener(\"mouseup\", regionEditorController.onMouseUpListener);\n            }\n            if (regionEditorControllerRef.current) {\n                const regionEditorController = regionEditorControllerRef.current;\n                document.removeEventListener(\"keydown\", regionEditorController.onKeyDownListener);\n                document.removeEventListener(\"keyup\", regionEditorController.onKeyUpListener);\n            }\n        };;\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [canvas]);\n\n    useEffect(() => {\n        if (!props.file) {\n            // reset editor\n            setImage(null);\n            return;\n        }\n\n        manipulateImage.loadImage(props.file, (image: HTMLImageElement) => {\n            setImage(image);\n        });\n\n    }, [props.file]);\n\n    useEffect(() => {\n        if (regionEditorControllerRef.current) {\n            regionEditorControllerRef.current.image = cacheImage;\n            regionEditorControllerRef.current.calcMargin(DEFAULT_MARGIN);\n            regionEditorControllerRef.current.category = props.selectedCategory;\n            regionEditorControllerRef.current.label = DEFAULT_LABEL;\n            regionEditorControllerRef.current.regionList = props.regionList;\n            regionEditorControllerRef.current.redraw();\n        }\n    }, [cacheImage, props.regionList, props.selectedCategory]);\n\n    useEffect(() => {\n        if (!canvas.current) {\n            return;\n        }\n        if (!canvasContainer.current) {\n            return;\n        }\n\n        canvas.current.width = canvasContainer.current.clientWidth;\n        canvas.current.height = canvasContainer.current.clientHeight;\n\n        if (regionEditorControllerRef.current) {\n            regionEditorControllerRef.current.redraw();\n        }\n    }, [canvas, canvasContainer]);\n\n    useEffect(() => {\n        if (regionEditorControllerRef.current) {\n            regionEditorControllerRef.current.selectedRegion = props.selectedRegion;\n            regionEditorControllerRef.current.redraw();\n        }\n    }, [props.selectedRegion]);\n\n    useEffect(() => {\n        if (!props.selectedCategory) {\n            return;\n        }\n\n        if (regionEditorControllerRef.current) {\n            regionEditorControllerRef.current.category = props.selectedCategory;\n        }\n    }, [props.selectedCategory]);\n\n    return (\n        <div className={classes.canvasContainer} ref={canvasContainer}>\n            <canvas className={classes.canvas} tabIndex={-1} ref={canvas} />\n        </div>\n    );\n}\n","\nexport function loadImage(file: File, onResizeCompleted) {\n  const fileReader = new FileReader();\n  fileReader.onload = (event) => {\n    const result = event.target?.result;\n    if (result == null) {\n      return;\n    }\n    const img = new Image();\n    img.src = result as string;\n\n    onResizeCompleted(img);\n  };\n  fileReader.readAsDataURL(file)\n}\n","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport * as React from 'react';\n\nimport { useEffect, useRef } from 'react';\nimport { createStyles, FormControl, InputLabel, makeStyles, MenuItem, Select, Theme } from '@material-ui/core';\n\nimport { Category } from '../entities/Category';\nimport * as apis from \"../api/crdbApi\";\nimport { Label } from '../entities/Label';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    root: {\n        overflowY: `scroll`,\n        backgroundColor: theme.palette.background.paper,\n    },\n    formControl: {\n        margin: theme.spacing(1),\n        minWidth: `120px`,\n    },\n    selectEmpty: {\n        marginTop: theme.spacing(2),\n    },\n}),\n);\n\nexport interface Callback {\n    onCategoriesUpdated(categoryList: Array<Category>): void\n    onCategorySelected(category: Category): void\n\n    onLabelsUpdated(labelList: Array<Label>): void\n}\n\ntype Props = {\n    categoryList: Array<Category> | null | undefined,\n    selectedCategory: Category | null | undefined,\n    callback: Callback,\n}\n\nexport function CategorySetting(props: Props) {\n    const classes = useStyles();\n\n    const categorySelect = useRef(null);\n\n    const getLabels = async (category: Category) => {\n        const labels = await apis.fetchLabels(category.id);\n        props.callback.onLabelsUpdated(labels);\n    };\n\n    const getCategories = async () => {\n        const categories = await apis.fetchCategories();\n        props.callback.onCategoriesUpdated(categories);\n        props.callback.onCategorySelected(categories[0]);\n        getLabels(categories[0]);\n    };\n\n    useEffect(() => {\n        getCategories();\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [categorySelect]);\n\n    const categorySelected = (event: React.ChangeEvent<{ value: unknown }>) => {\n        const value = event.target.value\n        if (typeof value === `number` && props.categoryList) {\n            const category: Array<Category> = props.categoryList.filter((category: Category) => { return category.id === value });\n            if (category) {\n                props.callback.onCategorySelected(category[0]);\n                getLabels(category[0]);\n            }\n        }\n    }\n\n    const selectedCategoryValue = () => {\n        if (!props.selectedCategory) {\n            return 0;\n        }\n        return props.selectedCategory.id;\n    }\n\n    const categoryList = () => {\n        if (!props.categoryList) {\n            return (<div></div>);\n        }\n        return props.categoryList.map((category: Category, index: number) => (\n            <MenuItem value={category.id}>{category.name}</MenuItem>\n        ));\n    }\n\n    return (\n        <div className={classes.root} >\n            <FormControl className={classes.formControl}>\n                <InputLabel id=\"demo-simple-select-label\">Category</InputLabel>\n                <Select\n                    value={selectedCategoryValue()}\n                    onChange={categorySelected}\n                    className={classes.selectEmpty}\n                >\n                    {categoryList()}\n                </Select>\n            </FormControl>\n        </div>\n    );\n}\n","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport React from 'react';\n\nimport {\n    Box, createStyles, IconButton, makeStyles, Paper,\n    Table, TableBody, TableCell, TableContainer, TableHead, TableRow,\n    Theme\n} from '@material-ui/core';\n\nimport { CategorySetting, Callback as CategorySettingCallback } from './CategorySetting';\nimport { Category } from '../entities/Category';\nimport { Region } from '../entities/Region';\nimport { Label } from '../entities/Label';\n\nimport MoveOrderUpIcon from '@material-ui/icons/ExpandLess';\nimport MoveOrderDownIcon from '@material-ui/icons/ExpandMore';\nimport RadioButtonUncheckedIcon from '@material-ui/icons/RadioButtonUnchecked';\nimport RadioButtonCheckedIcon from '@material-ui/icons/RadioButtonChecked';\nimport { REGION_LABEL_COLOR } from '../color';\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    root: {\n        height: `100%`,\n        overflowY: `scroll`,\n        backgroundColor: theme.palette.background.paper,\n    },\n    table: {\n        minWidth: `100%`,\n    },\n    labelIndicator: {\n        display: 'inline-block',\n        width: `16px`,\n        height: `16px`,\n        marginRight: `4px`,\n    }\n}),\n);\n\nexport interface Callback {\n    onChangeRegionList(regionList: Array<Region>): void\n    onCategoriesUpdated(categoryList: Array<Category>): void\n    onRegionSelected(region: Region): void\n}\n\ntype Props = {\n    selectedCategory: Category | undefined,\n    regionList: Array<Region> | undefined,\n    selectedRegion: Region | null,\n    categoryList: Array<Category> | undefined,\n    labelList: Array<Label> | undefined,\n    callback: Callback,\n    categorySettingCallback: CategorySettingCallback\n}\n\nexport function RegionList(props: Props) {\n    const classes = useStyles();\n\n    if (!props.regionList) {\n        return (<Box className={classes.root}></Box>);\n    }\n\n    const moveOrder = (regionList: Array<Region>, fromIndex: number, toIndex: number): Array<Region> => {\n        const resultRegionList = [...regionList];\n\n        const temp = resultRegionList[toIndex];\n        resultRegionList[toIndex] = resultRegionList[fromIndex];\n        resultRegionList[fromIndex] = temp;\n        return resultRegionList;\n    }\n\n    const moveOrderDown = (index: number) => {\n        if (!props.regionList) {\n            return;\n        }\n        const newIndex = index + 1;\n        const regionList = moveOrder(props.regionList, index, newIndex);\n\n        props.callback.onChangeRegionList(regionList);\n    }\n    const moveOrderUp = (index: number) => {\n        if (!props.regionList) {\n            return;\n        }\n        const newIndex = index - 1;\n        const regionList = moveOrder(props.regionList, index, newIndex);\n\n        props.callback.onChangeRegionList(regionList);\n    }\n\n    const orderIcons = (index: number) => {\n        if (!props.regionList) {\n            return;\n        }\n        if (index === 0) {\n            return (\n                <TableCell>\n                    <IconButton onClick={() => { moveOrderDown(index) }}>\n                        <MoveOrderDownIcon />\n                    </IconButton>\n                </TableCell>\n            );\n        } else if (index === (props.regionList.length - 1)) {\n            return (\n                <TableCell>\n                    <IconButton onClick={() => { moveOrderUp(index) }}>\n                        <MoveOrderUpIcon />\n                    </IconButton>\n                </TableCell>\n            );\n        } else {\n            return (\n                <TableCell>\n                    <IconButton onClick={() => { moveOrderUp(index) }}>\n                        <MoveOrderUpIcon />\n                    </IconButton>\n                    <IconButton onClick={() => { moveOrderDown(index) }}>\n                        <MoveOrderDownIcon />\n                    </IconButton>\n                </TableCell>\n            );\n        }\n    }\n\n    const selectedOrNot = (region: Region) => {\n        if (props.selectedRegion === region) {\n            return (<TableCell><RadioButtonCheckedIcon /></TableCell>);\n        }\n        return (<TableCell><RadioButtonUncheckedIcon /></TableCell>);\n\n    }\n\n    const selectRegion = (region: Region) => {\n        props.callback.onRegionSelected(region);\n    }\n\n    const label = (labelValue: number) => {\n        if (!props.labelList) {\n            return (<TableCell>{labelValue}</TableCell>);\n        }\n        const label = props.labelList.filter((label: Label) => { return label.label === labelValue })[0];\n        let labelName: string\n        if (label) {\n            labelName = label.name;\n        } else {\n            labelName = 'Unknown';\n        }\n\n        const chipLabel = `${labelValue}: ${labelName}`;\n        return (\n            <TableCell>\n                <span className={classes.labelIndicator} style={{ background: REGION_LABEL_COLOR[labelValue] }} />\n                {chipLabel}\n            </TableCell>\n        );\n    }\n\n    const showTable = () => {\n        if (!props.regionList || props.regionList.length === 0) {\n            return (<span></span>);\n        }\n\n        return (\n            <TableContainer component={Paper}>\n                <Table className={classes.table} aria-label=\"simple table\">\n                    <TableHead>\n                        <TableRow>\n                            <TableCell></TableCell>\n                            <TableCell>Label</TableCell>\n                            <TableCell align=\"center\">Order</TableCell>\n                        </TableRow>\n                    </TableHead>\n                    <TableBody>\n                        {props.regionList.map((region: Region, index: number) => (\n                            <TableRow key={index} onClick={() => { selectRegion(region) }}>\n                                {selectedOrNot(region)}\n                                {label(region.label)}\n                                {orderIcons(index)}\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n            </TableContainer>\n        );\n    }\n\n    return (\n        <Box className={classes.root}>\n            <CategorySetting\n                categoryList={props.categoryList}\n                selectedCategory={props.selectedCategory}\n                callback={props.categorySettingCallback} />\n\n            {showTable()}\n        </Box>\n    );\n}\n","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport * as React from 'react';\n\nimport { Dispatch, MutableRefObject, SetStateAction, useEffect, useRef, useState } from 'react';\n\nimport {\n    AppBar, Button, Container, createStyles,\n    Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle,\n    Grid, IconButton, makeStyles, Menu, MenuItem, Snackbar, SnackbarOrigin,\n    Theme, Toolbar, Tooltip, Typography\n} from '@material-ui/core';\n\nimport { Callback as RegionEditorCallback } from './RegionEditor/RegionEditorController';\nimport { Callback as RegionListCallback } from './RegionList';\nimport { Callback as CategorySettingCallback } from './CategorySetting';\n\nimport * as apis from \"../api/crdbApi\";\nimport { convertPointsToRegions, convertRegionsToPathRegions, Region } from '../entities/Region';\nimport { Label } from '../entities/Label';\nimport { Category } from '../entities/Category';\nimport { RegionEditor } from './RegionEditor/index';\nimport { RegionList } from './RegionList';\n\nimport UndoIcon from '@material-ui/icons/Undo';\nimport BackupIcon from '@material-ui/icons/Backup';\nimport CloudOffIcon from '@material-ui/icons/CloudOff';\nimport ImportExportIcon from '@material-ui/icons/ImportExport';\n\nimport { v4 as uuidv4 } from 'uuid';\n\nexport class EditHistory {\n    selectedRegion: Region | null\n    regionList: Array<Region>\n\n    constructor(selectedRegion: Region | null, regionList: Array<Region>) {\n        this.selectedRegion = selectedRegion;\n        this.regionList = regionList;\n    }\n}\n\nconst APP_TITLE = \"MRDB - Manga Region Database\";\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    root: {\n        width: `100%`,\n        height: `100%`,\n        backgroundColor: theme.palette.background.paper,\n        display: `flex`,\n    },\n    grid: {\n        top: `64px`,\n        height: `calc(100% - 64px)`,\n    },\n    regionEditor: {\n        height: `100%`,\n        backgroundColor: theme.palette.background.paper,\n        display: `flex`\n    },\n    regionList: {\n        height: `100%`,\n        backgroundColor: theme.palette.background.paper,\n        display: `flex`\n    },\n    title: {\n        flexGrow: 1,\n    },\n    menu: {\n    },\n}),\n);\n\nexport interface State extends SnackbarOrigin {\n    open: boolean;\n}\n\nexport interface Callback {\n    onTurnOnlineRequested(): void\n}\n\ntype Props = {\n    onlineMode: boolean,\n    selectedFile: File | null | undefined,\n    callback: Callback,\n    className: any\n}\n\n// https://stackoverflow.com/a/58439475\nfunction useStateRef<T>(initialValue: T): [T, Dispatch<SetStateAction<T>>, MutableRefObject<T>] {\n    const [value, setValue] = useState<T>(initialValue);\n\n    const ref = useRef<T>(value);\n\n    useEffect(() => {\n        ref.current = value;\n    }, [value]);\n\n    return [value, setValue, ref];\n}\n\nexport function RegionEditorContainer(props: Props) {\n    const classes = useStyles();\n\n    const idempotencyKey = useRef(uuidv4());\n\n    const [editingFile, setEditingFile] = useState<File | null | undefined>(null);\n    const [editingCategory, setEditingCategory] = useState<Category>()\n\n    const [isDirty, setDirty] = useState(false);\n    const [showSaveConfirmDialog, setShowSaveDialog] = useState(false);\n\n    const [anchorImportExportMenu, setAnchorImportExportMenu] = useState<null | HTMLElement>(null);\n    const importInput = useRef<null | HTMLInputElement>(null);\n\n    const [hashes, setHashes] = useState<{}>()\n\n    const [categoryList, setCategoryList] = useState<Array<Category>>()\n    const [selectedCategory, setSelectedCategory] = useState<Category>()\n\n    const [labelList, setLabelList] = useState<Array<Label>>()\n\n    const [selectedRegionState, setSelectedRegion, selectedRegionRef] = useStateRef<Region | null>(null);\n    const [regionListState, setRegionList, regionListRef] = useStateRef(new Array<Region>());\n    const [historyListState, setHistoryList, historyListRef] = useStateRef(new Array<EditHistory>());\n\n    const [snackbarText, setSnackbarText] = useState<string>(\"Hello\")\n\n    const [state, setState] = useState<State>({\n        open: false,\n        vertical: 'top',\n        horizontal: 'center',\n    });\n    const { vertical, horizontal, open } = state;\n\n    const regionEditorCallback = new (class implements RegionEditorCallback {\n        onSelectedRegion(selectedRegion: Region | null) {\n            setSelectedRegion(selectedRegion)\n        }\n        onAddedRegion(addedRegion: Region, newRegionList: Region[]) {\n            addEditHistory(selectedRegionRef.current, regionListRef.current);\n            setRegionList(newRegionList);\n        }\n        onDeletedRegion(deletedRegion: Region, newRegionList: Region[]) {\n            addEditHistory(selectedRegionRef.current, regionListRef.current);\n            setRegionList(newRegionList);\n        }\n        onChangedLabel(changedRegion: Region, newRegionList: Region[]) {\n            addEditHistory(selectedRegionRef.current, regionListRef.current);\n            setRegionList(newRegionList);\n        }\n        onDeformRegion(deformedRegion: Region, newRegionList: Region[]) {\n            addEditHistory(selectedRegionRef.current, regionListRef.current);\n            setRegionList(newRegionList);\n        }\n    })();\n\n    const regionListCallback = new (class implements RegionListCallback {\n        onChangeRegionList(newRegionList: Region[]): void {\n            addEditHistory(selectedRegionRef.current, regionListRef.current);\n            setRegionList(newRegionList);\n        }\n        onCategoriesUpdated(categoryList: Category[]): void {\n            const newCategoryList = [...categoryList];\n            setCategoryList(newCategoryList);\n        }\n        onRegionSelected(region: Region): void {\n            setSelectedRegion(region);\n        }\n    })();\n\n    const categorySettingCallback = new (class implements CategorySettingCallback {\n        onCategoriesUpdated(categoryList: Category[]): void {\n            const newCategoryList = [...categoryList];\n            setCategoryList(newCategoryList);\n        }\n        onCategorySelected(category: Category): void {\n            setSelectedCategory(category);\n        }\n        onLabelsUpdated(labelList: Label[]): void {\n            setLabelList(labelList);\n        }\n    })();\n\n    const handleError = (error: Error) => {\n        switch (error.message) {\n            case \"Failed to fetch\": {\n                setSnackbarText(\"A network error has occurred.\");\n                setState({ ...state, open: true });\n                break;\n            }\n            default: {\n                setSnackbarText(`${error.message}`);\n                setState({ ...state, open: true });\n                break;\n            }\n        }\n    }\n\n    const getRegions = async () => {\n        if (!props.selectedFile) {\n            return;\n        }\n\n        setRegionList(new Array<Region>());\n\n        if (!props.onlineMode) {\n            return;\n        }\n\n        try {\n            const h = await apis.fetchHash(props.selectedFile);\n            setHashes(h);\n\n            const result = await apis.fetchPageRegions(h, selectedCategory);\n            if (h === result.hashes) {\n                setRegionList(result.regions);\n            }\n        } catch (error) {\n            handleError(error);\n        }\n    }\n\n    useEffect(() => {\n        const onKeyDownListener = (event) => {\n            event.preventDefault();\n\n            if (event.key === 'z' && (event.ctrlKey || event.metaKey)) {\n                restoreEditHistory();\n            }\n        }\n\n        document.addEventListener(\"keydown\", onKeyDownListener);\n\n        return () => {\n            document.removeEventListener(\"keydown\", onKeyDownListener);\n        };\n    });\n\n    useEffect(() => {\n        const init = () => {\n            setDirty(false);\n            setHashes({});\n            setRegionList([]);\n            setHistoryList([]);\n        }\n\n        if (!props.selectedFile) {\n            init();\n            setEditingFile(props.selectedFile);\n            return;\n        }\n\n        if (isDirty) {\n            setShowSaveDialog(true);\n            return;\n        }\n\n        setEditingFile(props.selectedFile);\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [props.selectedFile]);\n\n    useEffect(() => {\n        if (!selectedCategory) {\n            return;\n        }\n\n        if (isDirty) {\n            setShowSaveDialog(true);\n            return;\n        }\n\n        setEditingCategory(selectedCategory);\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [selectedCategory]);\n\n    useEffect(() => {\n        getRegions();\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [props.onlineMode]);\n\n    useEffect(() => {\n        idempotencyKey.current = uuidv4();\n        clearEditHistory();\n\n        if (editingFile) {\n            getRegions();\n        }\n\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [editingFile, editingCategory]);\n\n    useEffect(() => {\n        const dirty = historyListState.length > 0;\n        setDirty(dirty);\n\n    }, [historyListState]);\n\n    const clearEditHistory = () => {\n        setHistoryList([]);\n    }\n\n    const restoreEditHistory = () => {\n        if (historyListState.length === 0) {\n            return;\n        }\n\n        const lastHistoryIndex = historyListState.length - 1;\n        const latestHistory = historyListState[lastHistoryIndex];\n        setRegionList(latestHistory.regionList);\n        setSelectedRegion(latestHistory.selectedRegion);\n\n        const newHistoryList = [...historyListState.slice(0, lastHistoryIndex)];\n        setHistoryList(newHistoryList);\n    }\n\n    const addEditHistory = (selectedRegion, regionList) => {\n        const newHistoryList = [...historyListRef.current, new EditHistory(selectedRegion, regionList)];\n        setHistoryList(newHistoryList);\n    }\n\n    const submitRegions = async () => {\n        if (!props.selectedFile) {\n            return;\n        }\n        if (!regionListState) {\n            return;\n        }\n\n        try {\n            if (!hashes) {\n                const h = await apis.fetchHash(props.selectedFile);\n                setHashes(h);\n            }\n            if (!hashes) {\n                return;\n            }\n\n            await apis.submitPageRegions(idempotencyKey.current, hashes, regionListState, selectedCategory);\n\n            setSnackbarText(\"Save completed.\");\n            setState({ ...state, open: true });\n            setDirty(false);\n        } catch (error) {\n            handleError(error);\n        }\n    };\n\n    const saveRegions = async () => {\n        if (!props.selectedFile) {\n            return;\n        }\n\n        if (!regionListState) {\n            return;\n        }\n\n        const regionsObj = convertRegionsToPathRegions(regionListState);\n        const jsonObj = {\n            \"file\": props.selectedFile.name,\n            \"regions\": regionsObj\n        }\n\n        if (hashes) {\n            jsonObj[\"image_ids\"] = {\n                \"dhash8\": hashes[\"dhash8\"],\n                \"dhash12\": hashes[\"dhash12\"],\n                \"dhash16\": hashes[\"dhash16\"],\n            }\n        }\n\n        const blob = new Blob([JSON.stringify(jsonObj, null, '  ')], { type: 'application/json' });\n        const url = URL.createObjectURL(blob);\n\n        const a = document.createElement(\"a\");\n        document.body.appendChild(a);\n        a.download = props.selectedFile.name + '.json';\n        a.href = url;\n        a.click();\n        a.remove();\n\n        URL.revokeObjectURL(url);\n    };\n\n    const title = () => {\n        if (!props.selectedFile) {\n            return APP_TITLE;\n        }\n        return props.selectedFile.name\n    }\n\n    const onSnackbarClose = () => {\n        setState({ ...state, open: false });\n    }\n\n    const undo = () => {\n        restoreEditHistory();\n    }\n\n    const menu = () => {\n        const showUndoMenu = () => {\n            if (!historyListState) {\n                return (<span></span>);\n            }\n            if (historyListState.length === 0) {\n                return (<span></span>);\n            }\n\n            return (\n                <Tooltip title=\"Undo (Ctrl + Z)\" aria-label=\"undo\">\n                    <IconButton color=\"inherit\" onClick={() => { undo(); }}>\n                        <UndoIcon />\n                    </IconButton>\n                </Tooltip>\n            );\n        };\n\n        const showServerMenu = () => {\n            const turnOnline = () => {\n                props.callback.onTurnOnlineRequested();\n            }\n\n            if (!props.onlineMode) {\n                return (\n                    <Tooltip title=\"Turn to online\" aria-label=\"turn-online-on\">\n                        <IconButton color=\"inherit\" onClick={turnOnline}>\n                            <CloudOffIcon />\n                        </IconButton>\n                    </Tooltip>\n                );\n            }\n\n            if (!isDirty) {\n                return (<span></span>);\n            }\n\n            return (\n                <Tooltip title=\"Save to server\" aria-label=\"submit-to-server\">\n                    <IconButton color=\"inherit\" onClick={submitRegions}>\n                        <BackupIcon />\n                    </IconButton>\n                </Tooltip>\n            );\n        };\n\n        const showImportExportMenu = () => {\n            if (!editingFile) {\n                return;\n            }\n\n            const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\n                setAnchorImportExportMenu(event.currentTarget);\n            }\n            const handleClose = () => {\n                setAnchorImportExportMenu(null);\n            }\n\n            const handleImport = () => {\n                handleClose();\n\n                if (!importInput.current) {\n                    return;\n                }\n                importInput.current.click();\n            }\n            const handleExport = () => {\n                handleClose();\n\n                saveRegions();\n            }\n\n            const handleChangeFile = (event) => {\n                event.preventDefault();\n\n                if (!regionListState) {\n                    return;\n                }\n\n                const files = event.target.files;\n                if (!files) {\n                    return;\n                }\n\n                const file = files[0];\n\n                var fileReader = new FileReader();\n                fileReader.onload = (e) => {\n                    const result = e.target?.result;\n                    if (!result) {\n                        return;\n                    }\n                    if (typeof result === 'string') {\n                        const jsonObj = JSON.parse(result as string);\n                        const regions = convertPointsToRegions(jsonObj['regions']);\n                        setRegionList(regions);\n                    }\n\n                    if (importInput.current) {\n                        importInput.current.value = \"\";\n                    }\n                };\n\n                fileReader.readAsText(file);\n            }\n\n            const showExportMenu = () => {\n                const disabled = (!regionListRef.current || regionListRef.current.length === 0);\n                if (disabled) {\n                    return (<MenuItem disabled onClick={handleExport}>Export</MenuItem>);\n                }\n                return (<MenuItem onClick={handleExport}>Export</MenuItem>);\n            }\n\n            return (\n                <span>\n                    <Menu\n                        id=\"simple-menu\"\n                        anchorEl={anchorImportExportMenu}\n                        keepMounted\n                        open={Boolean(anchorImportExportMenu)}\n                        onClose={handleClose}\n                    >\n                        <MenuItem onClick={handleImport}>Import</MenuItem>\n                        {showExportMenu()}\n                    </Menu >\n                    <Tooltip title=\"Export region data\" aria-label=\"export-regions\">\n                        <IconButton color=\"inherit\" onClick={handleClick}>\n                            <ImportExportIcon />\n                        </IconButton>\n                    </Tooltip>\n                    <input\n                        ref={importInput}\n                        type=\"file\"\n                        name=\"files[]\"\n                        id=\"file\"\n                        accept=\"application/json\"\n                        onChange={handleChangeFile}\n                        hidden\n                    />\n                </span >\n            );\n        }\n\n        return (\n            <div className={classes.menu}>\n                {showUndoMenu()}\n                {showServerMenu()}\n                {showImportExportMenu()}\n            </div>\n        );\n    }\n\n    const showSaveDialog = () => {\n        const handleSave = () => {\n            if (props.onlineMode) {\n                submitRegions();\n            } else {\n                saveRegions();\n            }\n\n            setRegionList([]);\n            setShowSaveDialog(false);\n            setEditingFile(props.selectedFile);\n            setEditingCategory(selectedCategory);\n        }\n\n        const handleDiscard = () => {\n            setRegionList([]);\n\n            setShowSaveDialog(false);\n            setEditingFile(props.selectedFile);\n            setEditingCategory(selectedCategory);\n        }\n\n        const showSaveButton = () => {\n            if (props.onlineMode) {\n                return (\n                    <DialogActions>\n                        <Button onClick={handleDiscard} color=\"primary\">\n                            Discard\n                        </Button>\n                        <Button onClick={handleSave} color=\"primary\" autoFocus>\n                            Save\n                        </Button>\n                    </DialogActions>\n                );\n            } else {\n                return (\n                    <DialogActions>\n                        <Button onClick={handleDiscard} color=\"primary\">\n                            Discard\n                        </Button>\n                        <Button onClick={handleSave} color=\"primary\" autoFocus>\n                            Save\n                        </Button>\n                    </DialogActions>\n                );\n            }\n        }\n        return (\n            <Dialog\n                open={showSaveConfirmDialog}\n                aria-labelledby=\"alert-dialog-title\"\n                aria-describedby=\"alert-dialog-description\"\n            >\n                <DialogTitle id=\"alert-dialog-title\">Save changes?</DialogTitle>\n                <DialogContent>\n                    <DialogContentText id=\"alert-dialog-description\">\n                        Do you want to save changes before opening an other file?\n              </DialogContentText>\n                </DialogContent>\n\n                {showSaveButton()}\n            </Dialog>\n        );\n    }\n\n    return (\n        <React.Fragment>\n            <AppBar position=\"static\">\n                <Toolbar>\n                    <Typography variant=\"h6\" className={classes.title}>\n                        {title()}\n                    </Typography>\n                    {menu()}\n                </Toolbar>\n            </AppBar>\n\n            <Snackbar\n                open={open}\n                onClose={onSnackbarClose}\n                message={snackbarText}\n                autoHideDuration={2000}\n                anchorOrigin={{ vertical, horizontal }}\n                key={vertical + horizontal}\n            />\n            <Grid container spacing={0} className={classes.grid}>\n                <Grid item xs={8} className={classes.regionEditor}>\n                    <RegionEditor\n                        file={editingFile}\n                        selectedCategory={editingCategory}\n                        regionList={regionListState}\n                        selectedRegion={selectedRegionState}\n                        callback={regionEditorCallback}\n                    />\n                </Grid>\n                <Grid item xs={4} className={classes.regionList} >\n                    <Container>\n                        <RegionList\n                            regionList={regionListState}\n                            selectedRegion={selectedRegionState}\n                            categoryList={categoryList}\n                            selectedCategory={editingCategory}\n                            labelList={labelList}\n                            callback={regionListCallback}\n                            categorySettingCallback={categorySettingCallback}\n                        />\n                    </Container>\n                </Grid>\n\n            </Grid>\n\n            {showSaveDialog()}\n\n        </React.Fragment>\n    );\n}\n","export default __webpack_public_path__ + \"static/media/add_photo_alternate-black-48dp.3723a89d.svg\";","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport * as React from 'react';\n\nimport { useState, useRef } from 'react';\n\nimport { Box, Container, GridList, IconButton } from '@material-ui/core';\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\n\nimport ClearIcon from '@material-ui/icons/Clear';\n\nimport add_photo_alternate_black from '../add_photo_alternate-black-48dp.svg';\n\n\nconst useStyles = makeStyles((theme: Theme) => createStyles({\n    root: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        justifyContent: 'space-around',\n        overflow: 'hidden',\n        backgroundColor: theme.palette.background.paper,\n    },\n    gridList: {\n        flexWrap: 'nowrap',\n        // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n        transform: 'translateZ(0)',\n    },\n    imageBoxContainerSelected: {\n        border: `1px solid #0000ff !important;`,\n    },\n    imageBoxContainer: {\n        width: `200px`,\n        height: `100%`,\n        minWidth: `150px`,\n        margin: `8px`,\n        border: `1px solid #cccccc`,\n        position: `relative`,\n    },\n    imageContainer: {\n        width: `100%`,\n        height: `100%`,\n        display: `flex`,\n        alignItems: `center`,\n        position: `absolute`,\n    },\n    image: {\n        objectFit: `cover`,\n        width: `100%`,\n        height: `auto`,\n        marginLeft: `auto`,\n        marginRight: `auto`,\n    },\n    imagePlaceholder: {\n        marginLeft: `auto`,\n        marginRight: `auto`,\n    },\n    boxFile: {\n        display: `none`,\n    },\n    tapContainer: {\n        width: `100%`,\n        height: `100%`,\n        position: `absolute`,\n        display: `flex`,\n        justifyContent: `flex-end`,\n        alignItems: `start`,\n    },\n    selectionBox: {\n        width: `100%`,\n        height: `100%`,\n        position: `absolute`,\n    },\n    clearIcon: {\n    },\n}),\n);\n\nexport interface Callback {\n    onFileSelected(file: File): void\n    onFileListUpdated(fileList: Array<File>): void\n}\n\ntype Props = {\n    selectedFile: File | null | undefined,\n    callback: Callback,\n}\n\nexport function ImageList(props: Props) {\n    const classes = useStyles();\n\n    const [imageFiles, setImageFiles] = useState(Array<File>());\n    const [previewImages, setPreviewImages] = useState(Array<string | ArrayBuffer>());\n\n    const fileInput = useRef<HTMLInputElement>(null)\n\n    const showFileDialog = () => {\n        const fileInputSnapshot = fileInput.current;\n        if (!fileInputSnapshot) {\n            return;\n        }\n        fileInputSnapshot.click();\n    }\n\n    function changeFile(event: any) {\n        event.preventDefault();\n\n        const files = event.target.files;\n        imageFiles.unshift(...files);\n        imageFiles.forEach((imageFile, index) => {\n            readFile(index);\n        });\n        setImageFiles([...imageFiles]);\n        props.callback.onFileListUpdated(imageFiles)\n    }\n\n    const readFile = (index: number) => {\n        if (!previewImages) {\n            return;\n        }\n\n        const fileReader = new FileReader();\n        fileReader.onload = (event) => {\n            const result = event.target?.result;\n            if (!result) {\n                return;\n            }\n            previewImages[index] = result;\n            setPreviewImages([...previewImages])\n        };\n        fileReader.readAsDataURL(imageFiles[index]);\n    };\n\n    const createPreviewImage = (image: string, imageAlt: string, classes, isSelected: boolean, onClick: (event: any) => void, onDelete: (event: any) => void) => {\n        const imageBoxClassName = () => {\n            if (isSelected) {\n                return (classes.imageBoxContainerSelected + ` ` + classes.imageBoxContainer);\n            } else {\n                return (classes.imageBoxContainer);\n            }\n        }\n        return (\n            <Box className={imageBoxClassName()}>\n                <Container className={classes.imageContainer}>\n                    <img className={classes.image} src={image} alt={imageAlt}/>\n                </Container>\n                <Box className={classes.tapContainer} >\n                    <Box className={classes.selectionBox} onClick={onClick} />\n                    <IconButton className={classes.clearIcon} color=\"inherit\" onClick={onDelete}>\n                        <ClearIcon />\n                    </IconButton>\n                </Box>\n            </Box>\n        )\n    }\n\n    const createPreviewImages = (classes, callback: Callback) => {\n        if (!previewImages) {\n            return;\n        }\n\n        return (\n            previewImages.map((image, index: number) => {\n                const file = imageFiles[index];\n                const onSelect = (event: any) => {\n                    event.preventDefault();\n\n                    callback.onFileSelected(file);\n                };\n                const onDelete = (event: any) => {\n                    event.preventDefault();\n\n                    const index = imageFiles.indexOf(file);\n                    if (index === -1) {\n                        return;\n                    }\n\n                    imageFiles.splice(index, 1);\n                    previewImages.splice(index, 1);\n\n                    setImageFiles([...imageFiles]);\n                    setPreviewImages([...previewImages])\n\n                    props.callback.onFileListUpdated(imageFiles)\n                };\n                if (typeof image === 'string') {\n                    return createPreviewImage(\n                        image, file.name,\n                        classes,\n                        (file === props.selectedFile),\n                        onSelect, onDelete);\n                }\n                return image;\n            })\n        )\n    }\n\n    return (\n        <div className={classes.root}>\n            <GridList className={classes.gridList}>\n\n                <Box className={classes.imageBoxContainer}>\n                    <Box className={classes.imageContainer} onClick={showFileDialog}>\n                        <img className={classes.imagePlaceholder} src={add_photo_alternate_black} alt=\"add_image\" />\n                    </Box>\n                </Box>\n\n                {createPreviewImages(classes, props.callback)}\n                <input\n                    ref={fileInput}\n                    className={classes.boxFile}\n                    type=\"file\"\n                    name=\"files[]\"\n                    id=\"file\"\n                    accept=\"image/*\"\n                    multiple\n                    onChange={changeFile}\n                />\n            </GridList>\n        </div>\n    );\n}\n","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport * as React from 'react';\n\nimport { useRef, useState } from 'react';\n\nimport clsx from 'clsx';\nimport { Drawer, IconButton, CssBaseline, Paper, Box, Dialog, DialogContent, DialogTitle, DialogContentText, DialogActions, Button, Typography, Tooltip } from '@material-ui/core';\n\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles';\n\nimport OpenDrawerIcon from '@material-ui/icons/ExpandLess';\nimport CloseDrawerIcon from '@material-ui/icons/ExpandMore';\nimport NavigateNextIcon from '@material-ui/icons/NavigateNext';\nimport NavigateBeforeIcon from '@material-ui/icons/NavigateBefore';\nimport SaveAltIcon from '@material-ui/icons/SaveAlt';\n\nimport { RegionEditorContainer, Callback as RegionEditorContainerCallback } from './components/RegionEditorContainer';\nimport { ImageList, Callback } from './components/ImageList';\n\nimport * as apis from \"./api/crdbApi\";\n\n// https://techracho.bpsinc.jp/hachi8833/2019_10_09/80851\nconst KEY_AGREEMENT = 'agreement';\nconst LATEST_AGREEMENT_DATE = '20201006';\n\nconst drawerHeight = 210;\nconst drawerHeaderHeight = 64;\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      display: 'block',\n      height: `100vh`,\n    },\n    main: {\n      height: `calc(100% - ${drawerHeaderHeight}px)`,\n      width: `100%`,\n    },\n    drawerHeader: {\n      display: 'flex',\n      alignItems: 'center',\n      padding: theme.spacing(1, 1),\n      justifyContent: 'flex-end',\n      position: `fixed`,\n      ...theme.mixins.toolbar,\n      top: 'auto',\n      bottom: `0px`,\n      width: `100%`,\n      backgroundColor: theme.palette.background.paper,\n    },\n    grow: {\n      flexGrow: 1,\n      textAlign: `center`,\n    },\n    drawerHeaderShift: {\n      marginBottom: `calc(${drawerHeight}px)`,\n      transition: theme.transitions.create(['margin', 'height'], {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n    },\n    drawer: {\n    },\n    drawerPaper: {\n      height: drawerHeight,\n    },\n    drawerHeaderPaper: {\n      paddingLeft: `16dp`,\n    },\n    content: {\n      flexGrow: 1,\n      padding: theme.spacing(3),\n      transition: theme.transitions.create('margin', {\n        easing: theme.transitions.easing.sharp,\n        duration: theme.transitions.duration.leavingScreen,\n      }),\n      marginBottom: -drawerHeight,\n    },\n    contentShift: {\n      transition: theme.transitions.create(['margin', 'height'], {\n        easing: theme.transitions.easing.easeOut,\n        duration: theme.transitions.duration.enteringScreen,\n      }),\n      marginBottom: `calc(${drawerHeight}px)`,\n    },\n  }),\n);\n\n\nfunction App() {\n  const [onlineMode, setOnlineMode] = useState(true);\n\n  const [imageListShown, setImageListShown] = useState(true);\n  const [fileList, setFileList] = useState<Array<File>>();\n\n  const [selectedFile, setFile] = useState<File | null>();\n\n  const agreementDate = localStorage.getItem(KEY_AGREEMENT);\n  const [agreementDialogShown, showAgreementDialog] = useState(agreementDate ? !(agreementDate === LATEST_AGREEMENT_DATE) : true);\n\n  const rootElement = useRef<HTMLDivElement>(null);\n\n  const classes = useStyles();\n\n  const prevFile = () => {\n    if (!selectedFile) {\n      return\n    }\n    if (!fileList) {\n      return\n    }\n    const currentIndex = fileList.indexOf(selectedFile)\n    if (currentIndex < 0) {\n      return;\n    }\n\n    const index = currentIndex - 1;\n    if (index >= 0) {\n      setFile(fileList[index]);\n    }\n  }\n\n  const nextFile = () => {\n    if (!selectedFile) {\n      return\n    }\n    if (!fileList) {\n      return\n    }\n    const currentIndex = fileList.indexOf(selectedFile)\n    if (currentIndex < 0) {\n      return;\n    }\n\n    const index = currentIndex + 1;\n    if (index < fileList.length) {\n      setFile(fileList[index]);\n    }\n  }\n\n  const callback = new (class implements Callback {\n    onFileListUpdated(fileList: File[]): void {\n      setFileList(fileList);\n\n      if (!selectedFile) {\n        return;\n      }\n\n      // The selected file is removed from list.\n      if (fileList.indexOf(selectedFile) === -1) {\n        setFile(null);\n      }\n    }\n\n    onFileSelected(file: File) {\n      setFile(file);\n    }\n  })();\n\n  const regionEditorContainerCallback = new (class implements RegionEditorContainerCallback {\n    onTurnOnlineRequested(): void {\n      showAgreementDialog(true);\n    }\n  })();\n\n  const toggleDrawer = () => {\n    setImageListShown(!imageListShown);\n  }\n\n  const getHashList = async (fileList: Array<File>) => {\n    const result: { [key: string]: {} } = {};\n\n    for (const f of fileList) {\n      const imageIds = await apis.fetchHash(f);\n      result[f.name] = {\n        \"image_ids\": imageIds,\n        \"url\": apis.fetchPageRegionsUrl(imageIds, null, true)\n      };\n    }\n    return result;\n  }\n\n  const exportRegions = async () => {\n    if (!fileList) {\n      return;\n    }\n\n    const hashList = await getHashList(fileList)\n\n    const blob = new Blob([JSON.stringify(hashList, null, '  ')], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n\n    const a = document.createElement(\"a\");\n    document.body.appendChild(a);\n    a.download = 'export.json';\n    a.href = url;\n    a.click();\n    a.remove();\n\n    URL.revokeObjectURL(url);\n  }\n\n  const onKeyDownListener = (event) => {\n    if (event.key === ' ') {\n      event.preventDefault();\n      toggleDrawer();\n    }\n  }\n\n  const agreementDialog = () => {\n    const handleAgree = () => {\n      setOnlineMode(true);\n      localStorage.setItem(KEY_AGREEMENT, LATEST_AGREEMENT_DATE);\n      showAgreementDialog(false);\n    }\n    const handleDisagree = () => {\n      setOnlineMode(false);\n      showAgreementDialog(false);\n    }\n\n    return (\n      <Dialog\n        open={agreementDialogShown}\n        aria-labelledby=\"alert-dialog-title\"\n        aria-describedby=\"alert-dialog-description\"\n      >\n        <DialogTitle id=\"alert-dialog-title\">Online mode(Agreement)</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-description\">\n            In online mode, image files will be uploaded to our server for generate image-ids by \"imagehash\" algorithm.\n            And image files will be stored for improving our services.<br />\n            ROI(Region of Interest) data and image-ids will be uploaded, stored, and redistribute for all users.<br />\n            <br />\n            We <strong>DO NOT</strong> redistribute your image files.\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleDisagree} color=\"primary\">\n            Decline (Continue offline)\n          </Button>\n          <Button onClick={handleAgree} color=\"primary\">\n            Agree\n          </Button>\n        </DialogActions>\n      </Dialog>\n    );\n  }\n\n  const showExportButton = () => {\n    if (!onlineMode) {\n      return (<span></span>);\n    }\n\n    return (\n      <Tooltip title=\"Export all image-IDs\" aria-label=\"export-image-ids\">\n        <IconButton color=\"inherit\" onClick={exportRegions}>\n          <SaveAltIcon />\n        </IconButton>\n      </Tooltip>\n    );\n  }\n  const showButtons = () => {\n    if (!fileList || fileList.length === 0) {\n      return (<Box></Box>);\n    }\n    return (\n      <Box>\n        <Tooltip title=\"Prev file\" aria-label=\"prev-file\">\n          <IconButton color=\"inherit\" onClick={prevFile}>\n            <NavigateBeforeIcon />\n          </IconButton>\n        </Tooltip>\n        <Tooltip title=\"Next file\" aria-label=\"next-file\">\n          <IconButton color=\"inherit\" onClick={nextFile}>\n            <NavigateNextIcon />\n          </IconButton>\n        </Tooltip>\n\n        {showExportButton()}\n      </Box>\n    );\n  }\n\n  const toggleDrawerTitle = () => {\n    return imageListShown ? \"Close (Space)\" : \"Open (Space)\";\n  }\n\n  return (\n    <div className=\"App\" ref={rootElement} onKeyDown={onKeyDownListener} tabIndex={-1}>\n      <CssBaseline />\n\n      <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap\" />\n      <link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/icon?family=Material+Icons\" />\n\n      <div className={classes.root}>\n        <Drawer\n          className={classes.drawer}\n          variant=\"persistent\"\n          anchor=\"bottom\"\n          open={imageListShown}\n          classes={{\n            paper: classes.drawerPaper,\n          }}\n        >\n          <ImageList\n            selectedFile={selectedFile}\n            callback={callback} />\n        </Drawer>\n\n        <main className={classes.main}>\n          <RegionEditorContainer\n            selectedFile={selectedFile}\n            onlineMode={onlineMode}\n            callback={regionEditorContainerCallback}\n            className={clsx(classes.content, {\n              [classes.contentShift]: imageListShown,\n            })}\n          />\n        </main>\n      </div>\n\n      <Paper elevation={1} className={clsx(classes.drawerHeaderPaper, classes.drawerHeader, {\n        [classes.drawerHeaderShift]: imageListShown,\n      })}>\n        <Tooltip title={toggleDrawerTitle()} aria-label=\"toggle-drawer\">\n          <IconButton onClick={toggleDrawer} color=\"inherit\" aria-label=\"open drawer\">\n            {!imageListShown ? <OpenDrawerIcon /> : <CloseDrawerIcon />}\n          </IconButton>\n        </Tooltip>\n\n        <div className={classes.grow}>\n          <Typography variant='caption'>Copyright 2020 Keiji ARIYAMA (C-LIS CO., LTD.)</Typography>\n        </div>\n\n        {showButtons()}\n      </Paper>\n\n      {agreementDialog()}\n\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","// eslint-disable-next-line @typescript-eslint/no-use-before-define\nimport * as React from 'react';\n\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}